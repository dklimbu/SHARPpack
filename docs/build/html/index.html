

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SHARP Pack documentation &mdash; SHARP Pack 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="_static/rpsh.png"/>
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=f2a433a1"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            SHARP Pack
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">SHARP Pack documentation</a></li>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#models">Models</a><ul>
<li><a class="reference internal" href="#tully-models">Tully Models</a><ul>
<li><a class="reference internal" href="#morse-potential-models">Morse Potential Models</a></li>
<li><a class="reference internal" href="#spin-boson-model">Spin-Boson Model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sample-initialization">Sample Initialization</a><ul>
<li><a class="reference internal" href="#tully-model">Tully Model</a></li>
<li><a class="reference internal" href="#morse-model">Morse Model</a></li>
<li><a class="reference internal" href="#id1">Spin-Boson Model</a></li>
</ul>
</li>
<li><a class="reference internal" href="#frustrated-hops-in-tully-model">Frustrated Hops in Tully Model</a></li>
<li><a class="reference internal" href="#compilation">Compilation</a></li>
<li><a class="reference internal" href="#input-file-param-in">Input File: param.in</a></li>
<li><a class="reference internal" href="#output-files">Output Files</a></li>
<li><a class="reference internal" href="#running-simulations">Running Simulations</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">SHARP Pack</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">SHARP Pack documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sharp-pack-documentation">
<h1>SHARP Pack documentation<a class="headerlink" href="#sharp-pack-documentation" title="Link to this heading"></a></h1>
<figure class="align-center">
<a class="reference internal image-reference" href="_images/rpsh.png"><img alt="SHARPPack" src="_images/rpsh.png" style="width: 243.8px; height: 178.60000000000002px;" />
</a>
</figure>
<p>Welcome to <strong>SHARP Pack</strong> documentation,</p>
<div class="toctree-wrapper compound">
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This website is in under active development…</p>
</div>
</section>
<section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h1>
<p>Non-adiabatic dynamics—quantum transitions between electronic and/or vibronic states—is a critical process in electrochemical and photoelectrochemical reactions, including those involved in natural and artificial energy conversion systems.</p>
<p>Simulating these processes accurately in condensed phases with thousands of degrees of freedom (DOFs), especially when nuclear quantum effects (NQEs) like proton tunneling and zero-point energy are significant, is computationally demanding.</p>
<p><strong>Mixed quantum-classical dynamics (MQCD)</strong> methods address this by treating only light particles quantum-mechanically and treating the environment classically.</p>
<p>One of the most widely used MQCD methods is <strong>Fewest-Switches Surface Hopping (FSSH)</strong>, where the quantum wavepacket is represented by classical trajectories traveling on a single adiabatic surface interrupted by hops to other surfaces.</p>
<p>However, independent classical trajectories used in FSSH are not able to capture decoherence or NQEs accurately.</p>
<p>Approaches like <strong>Centroid Molecular Dynamics (CMD)</strong> and <strong>Ring Polymer Molecular Dynamics (RPMD)</strong> offer a way to model NQEs, but have limitations for multi-electron transfer or real-time electronic coherence effects.</p>
<p><strong>Ring Polymer Surface Hopping (RPSH)</strong> is a method that combines RPMD and FSSH to overcome these challenges.</p>
<p>SHARP Pack—short for <em>Surface Hopping And Ring Polymer</em> package—is a modular, parallelized, and user-friendly software that implements RPSH, enabling simulations from model systems to more realistic applications.</p>
<p>Features of SHARP Pack:</p>
<ul class="simple">
<li><p>Coupled electronic-nuclear motion</p></li>
<li><p>Surface hopping algorithm</p></li>
<li><p>Feynman’s path integral formalism</p></li>
<li><p>Extensible for new methodologies and models</p></li>
<li><p>Efficient yet accurate nonadiabatic dynamics</p></li>
</ul>
</section>
<section id="models">
<h1>Models<a class="headerlink" href="#models" title="Link to this heading"></a></h1>
<span id="tab-model"></span><table class="docutils align-default" id="id2">
<caption><span class="caption-text">Models implemented in SHARP Pack</span><a class="headerlink" href="#id2" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Keyword</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>tully1</cite></p></td>
<td><p>Tully’s Simple Avoided Crossing Model</p></td>
</tr>
<tr class="row-odd"><td><p><cite>tully2</cite></p></td>
<td><p>Tully’s Dual Avoided Crossing Model</p></td>
</tr>
<tr class="row-even"><td><p><cite>tully3</cite></p></td>
<td><p>Tully’s Extended Coupling with Reflection Model</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Morse Models</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><cite>morse1</cite></p></td>
<td><p>Morse Model I – photo-dissociation</p></td>
</tr>
<tr class="row-odd"><td><p><cite>morse2</cite></p></td>
<td><p>Morse Model II – photo-dissociation</p></td>
</tr>
<tr class="row-even"><td><p><cite>morse3</cite></p></td>
<td><p>Morse Model III – photo-dissociation</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Detailed Balance Models</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><cite>db2lchain</cite></p></td>
<td><p>2-state model coupled with linear chain</p></td>
</tr>
<tr class="row-odd"><td><p><cite>db3lchain</cite></p></td>
<td><p>3-state super-exchange model with linear chain coupling</p></td>
</tr>
</tbody>
</table>
<section id="tully-models">
<h2>Tully Models<a class="headerlink" href="#tully-models" title="Link to this heading"></a></h2>
<p>Diabatic Hamiltonians:</p>
<p><strong>Model I</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}V_{11}(R) =
\begin{cases}
   A(1 - e^{-B R}) &amp; \text{if } R &gt; 0 \\
  -A(1 - e^{B R})  &amp; \text{if } R &lt; 0
\end{cases}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[V_{22}(R) = -V_{11}(R)\]</div>
<div class="math notranslate nohighlight">
\[V_{12}(R) = V_{21}(R) = C e^{-D R^2}\]</div>
<p><strong>Model II</strong></p>
<div class="math notranslate nohighlight">
\[V_{11}(R) = 0\]</div>
<div class="math notranslate nohighlight">
\[V_{22}(R) = -A e^{-B R^2} + E_0\]</div>
<div class="math notranslate nohighlight">
\[V_{12}(R) = V_{21}(R) = C e^{-D R^2}\]</div>
<p><strong>Model III</strong></p>
<div class="math notranslate nohighlight">
\[V_{11}(R) = A, \quad V_{22}(R) = -A\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}V_{12}(R) = V_{21}(R) =
\begin{cases}
  B e^{C R}, &amp; \text{if } R &lt; 0 \\
  B(2 - e^{-C R}), &amp; \text{if } R &gt; 0
\end{cases}\end{split}\]</div>
<p><strong>Parameters (atomic units):</strong></p>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Tully Model Parameters</span><a class="headerlink" href="#id3" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 18.2%" />
<col style="width: 27.3%" />
<col style="width: 27.3%" />
<col style="width: 27.3%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Model I</strong></p></th>
<th class="head"><p><strong>Model II</strong></p></th>
<th class="head"><p><strong>Model III</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A</p></td>
<td><p>0.01</p></td>
<td><p>0.1</p></td>
<td><p>6e-4</p></td>
</tr>
<tr class="row-odd"><td><p>B</p></td>
<td><p>1.6</p></td>
<td><p>0.28</p></td>
<td><p>0.1</p></td>
</tr>
<tr class="row-even"><td><p>C</p></td>
<td><p>0.005</p></td>
<td><p>0.015</p></td>
<td><p>0.9</p></td>
</tr>
<tr class="row-odd"><td><p>D</p></td>
<td><p>1.0</p></td>
<td><p>0.06</p></td>
<td><p>–</p></td>
</tr>
<tr class="row-even"><td><p>E₀</p></td>
<td><p>–</p></td>
<td><p>0.05</p></td>
<td><p>–</p></td>
</tr>
</tbody>
</table>
<section id="morse-potential-models">
<h3>Morse Potential Models<a class="headerlink" href="#morse-potential-models" title="Link to this heading"></a></h3>
<div class="math notranslate nohighlight">
\[V_{ii}(R) = D_{e,i} \left(1 - e^{-\beta_i(R - R_{e,i})} \right)^2 + c_i\]</div>
<div class="math notranslate nohighlight">
\[V_{ij}(R) = A_{ij} e^{-a_{ij}(R - R_{ij})^2}, \quad V_{ji}(R) = V_{ij}(R)\]</div>
<table class="docutils align-center" id="id4">
<caption><span class="caption-text">Numerical values of the parameters related to the three Morse potential models (in a.u.)</span><a class="headerlink" href="#id4" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
<col style="width: 10.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"></th>
<th class="head"><p><strong>Model I</strong></p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"><p><strong>Model II</strong></p></th>
<th class="head"></th>
<th class="head"></th>
<th class="head"><p><strong>Model III</strong></p></th>
<th class="head"></th>
</tr>
<tr class="row-even"><th class="head"><p><strong>Param</strong></p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
<th class="head"><p>1</p></th>
<th class="head"><p>2</p></th>
<th class="head"><p>3</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(D_{e,i}\)</span></p></td>
<td><p>0.003</p></td>
<td><p>0.004</p></td>
<td><p>0.003</p></td>
<td><p>0.02</p></td>
<td><p>0.01</p></td>
<td><p>0.003</p></td>
<td><p>0.02</p></td>
<td><p>0.02</p></td>
<td><p>0.003</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_i\)</span></p></td>
<td><p>0.65</p></td>
<td><p>0.60</p></td>
<td><p>0.65</p></td>
<td><p>0.65</p></td>
<td><p>0.40</p></td>
<td><p>0.65</p></td>
<td><p>0.40</p></td>
<td><p>0.65</p></td>
<td><p>0.65</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(R_{e,i}\)</span></p></td>
<td><p>5.0</p></td>
<td><p>4.0</p></td>
<td><p>6.0</p></td>
<td><p>4.5</p></td>
<td><p>4.0</p></td>
<td><p>4.4</p></td>
<td><p>4.0</p></td>
<td><p>4.5</p></td>
<td><p>6.0</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(c_i\)</span></p></td>
<td><p>0.00</p></td>
<td><p>0.01</p></td>
<td><p>0.006</p></td>
<td><p>0.00</p></td>
<td><p>0.01</p></td>
<td><p>0.02</p></td>
<td><p>0.02</p></td>
<td><p>0.00</p></td>
<td><p>0.02</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(ij\)</span></p></td>
<td><p>12</p></td>
<td><p>13</p></td>
<td><p>23</p></td>
<td><p>12</p></td>
<td><p>13</p></td>
<td><p>23</p></td>
<td><p>12</p></td>
<td><p>13</p></td>
<td><p>23</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(A_{ij}\)</span></p></td>
<td><p>0.002</p></td>
<td><p>0.0</p></td>
<td><p>0.002</p></td>
<td><p>0.005</p></td>
<td><p>0.005</p></td>
<td><p>0.0</p></td>
<td><p>0.005</p></td>
<td><p>0.005</p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(R_{ij}\)</span></p></td>
<td><p>3.40</p></td>
<td><p>0.0</p></td>
<td><p>4.80</p></td>
<td><p>3.66</p></td>
<td><p>3.34</p></td>
<td><p>0.0</p></td>
<td><p>3.40</p></td>
<td><p>4.97</p></td>
<td><p>0.0</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(a_{ij}\)</span></p></td>
<td><p>16.0</p></td>
<td><p>0.0</p></td>
<td><p>16.0</p></td>
<td><p>32.0</p></td>
<td><p>32.0</p></td>
<td><p>0.0</p></td>
<td><p>32.0</p></td>
<td><p>32.0</p></td>
<td><p>0.0</p></td>
</tr>
</tbody>
</table>
</section>
<section id="spin-boson-model">
<h3>Spin-Boson Model<a class="headerlink" href="#spin-boson-model" title="Link to this heading"></a></h3>
<p>Total Hamiltonian:</p>
<div class="math notranslate nohighlight">
\[H = H_s + H_b + H_{sb}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(H_s\)</span>: Spin system (2-level)</p></li>
<li><p><span class="math notranslate nohighlight">\(H_b\)</span>: Harmonic bath</p></li>
<li><p><span class="math notranslate nohighlight">\(H_{sb}\)</span>: System-bath coupling</p></li>
</ul>
<p>Spectral density:</p>
<div class="math notranslate nohighlight">
\[J(\omega) = \frac{E_r}{2} \cdot \frac{\omega \omega_c}{\omega^2 + \omega_c^2}\]</div>
<p>Discretized mode sampling:</p>
<div class="math notranslate nohighlight">
\[\omega_j = \tan\left(\frac{j}{N} \tan^{-1}\left(\frac{\omega_{\text{max}}}{\omega_c}\right)\right) \cdot \omega_c\]</div>
<div class="math notranslate nohighlight">
\[c_j = \omega_j \sqrt{\frac{E_r}{\pi N} \tan^{-1}\left(\frac{\omega_{\text{max}}}{\omega_c}\right)}\]</div>
</section>
</section>
<section id="sample-initialization">
<h2>Sample Initialization<a class="headerlink" href="#sample-initialization" title="Link to this heading"></a></h2>
<section id="tully-model">
<h3>Tully Model<a class="headerlink" href="#tully-model" title="Link to this heading"></a></h3>
<p>Gaussian wavepacket:</p>
<div class="math notranslate nohighlight">
\[\langle R|\chi(R)\rangle = \left(\frac{2\alpha}{\pi}\right)^{1/4} \exp\left[-\alpha(R - R_0)^2 - \frac{iR(P - P_0)}{\hbar} \right]\]</div>
<p>Wigner distribution:</p>
<div class="math notranslate nohighlight">
\[\rho^W_R = \frac{1}{\pi \hbar} \exp\left[-2\alpha(R - R_0)^2 - \frac{(P - P_0)^2}{2\alpha \hbar^2} \right]\]</div>
<p>Constants:</p>
<table class="docutils align-default" id="id5">
<caption><span class="caption-text">Constants for Tully Models</span><a class="headerlink" href="#id5" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Value</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\alpha\)</span></p></td>
<td><p>0.25</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>2000</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\sigma_R\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sqrt{1 / 2\alpha}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\sigma_P\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sqrt{\hbar^2 \alpha / 2}\)</span></p></td>
</tr>
</tbody>
</table>
</section>
<section id="morse-model">
<h3>Morse Model<a class="headerlink" href="#morse-model" title="Link to this heading"></a></h3>
<table class="docutils align-default" id="id6">
<caption><span class="caption-text">Morse Model Initialization</span><a class="headerlink" href="#id6" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Parameter</strong></p></th>
<th class="head"><p><strong>Value</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(m\)</span></p></td>
<td><p>20000</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\omega_0\)</span></p></td>
<td><p>0.005</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\sigma_R\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sqrt{\frac{\hbar}{2 m \omega_0}}\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\sigma_P\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\sqrt{\frac{m \hbar \omega_0}{2}}\)</span></p></td>
</tr>
</tbody>
</table>
</section>
<section id="id1">
<h3>Spin-Boson Model<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<p>Boltzmann sampling:</p>
<div class="math notranslate nohighlight">
\[P(p, q) \propto \prod \exp\left[-\beta \left(\frac{p^2}{2m} + \frac{1}{2} m \omega^2 q^2 \right)\right]\]</div>
<p>Wigner sampling:</p>
<div class="math notranslate nohighlight">
\[\sigma^w_R = \sqrt{\frac{\hbar}{2m\omega \tanh(\beta \hbar \omega / 2)}}\]</div>
<div class="math notranslate nohighlight">
\[\sigma^w_P = \sqrt{\frac{m \hbar \omega}{2 \tanh(\beta \hbar \omega / 2)}}\]</div>
</section>
</section>
<section id="frustrated-hops-in-tully-model">
<h2>Frustrated Hops in Tully Model<a class="headerlink" href="#frustrated-hops-in-tully-model" title="Link to this heading"></a></h2>
<p>Velocity rescaling after hopping:</p>
<div class="math notranslate nohighlight">
\[\dot{R}'_i = \dot{R}_i - \gamma \frac{d_{kk'}^i}{m_i}\]</div>
<p>Velocity reversal strategies:</p>
<table class="docutils align-default" id="id7">
<caption><span class="caption-text">Velocity Reversal Options</span><a class="headerlink" href="#id7" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Option</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>never</cite></p></td>
<td><p>Never reverse momentum</p></td>
</tr>
<tr class="row-odd"><td><p><cite>always</cite></p></td>
<td><p>Always reverse on failed hop</p></td>
</tr>
<tr class="row-even"><td><p><cite>truhlar</cite></p></td>
<td><p>Use Truhlar’s criterion</p></td>
</tr>
<tr class="row-odd"><td><p><cite>subotnik</cite></p></td>
<td><p>Use Subotnik’s criterion</p></td>
</tr>
</tbody>
</table>
</section>
<section id="compilation">
<h2>Compilation<a class="headerlink" href="#compilation" title="Link to this heading"></a></h2>
<p>Requirements:</p>
<ul class="simple">
<li><p>Linux OS</p></li>
<li><p>Intel Fortran compiler</p></li>
<li><p>BLAS, LAPACK, FFTW3</p></li>
</ul>
<p>Build:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>source/
make
</pre></div>
</div>
<p>Output: <cite>bin/sharp.x</cite></p>
<table class="docutils align-center" id="id8">
<caption><span class="caption-text">Input Keywords</span><a class="headerlink" href="#id8" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 15.0%" />
<col style="width: 65.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>Keywords</strong></p></th>
<th class="head"><p><strong>Arguments</strong></p></th>
<th class="head"><p><strong>Descriptions</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>model</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(s\)</span></p></td>
<td><p>Model name string from Table <a class="reference internal" href="#tab-model"><span class="std std-ref">Models implemented in SHARP Pack</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><strong>nbeads</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>Number of bead(s)</p></td>
</tr>
<tr class="row-even"><td><p><strong>nparticle</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>Number of simulating particle(s)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>nsteps</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>Number of simulation steps</p></td>
</tr>
<tr class="row-even"><td><p><strong>ntraj</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>Number of trajectories</p></td>
</tr>
<tr class="row-odd"><td><p><strong>nstates</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\color{blue}{n}\)</span></p></td>
<td><p>Number of electronic states; Default based on Model</p></td>
</tr>
<tr class="row-even"><td><p><strong>ncpu</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>Number of CPU(s) (1-Serial), (n-Parallel)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>timestep</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(f\)</span></p></td>
<td><p>Simulation time-step (a.u.)</p></td>
</tr>
<tr class="row-even"><td><p><strong>temp</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(f\)</span></p></td>
<td><p>Temperature (K)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>kinitial</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(f\)</span></p></td>
<td><p>Initial momentum (a.u.)</p></td>
</tr>
<tr class="row-even"><td><p><strong>beadpos</strong></p></td>
<td><p><cite>same</cite></p></td>
<td><p>Assign same position for bead(s) of each particle</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><span class="math notranslate nohighlight">\(\color{blue}{\text{gaussian}}\)</span></p></td>
<td><p>Initial (beads) position from Gaussian distribution</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p><cite>wigner</cite></p></td>
<td><p>Initial (beads) position from Wigner distribution</p></td>
</tr>
<tr class="row-odd"><td><p><strong>vinitial</strong></p></td>
<td><p><cite>fixed</cite></p></td>
<td><p>Deterministic initial momentum</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p><span class="math notranslate nohighlight">\(\color{blue}{\text{gaussian}}\)</span></p></td>
<td><p>Initial momentum from Gaussian distribution</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><cite>wigner</cite></p></td>
<td><p>Initial momentum from Wigner distribution</p></td>
</tr>
<tr class="row-even"><td><p><strong>vreverse</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\color{blue}{\text{never}}\)</span></p></td>
<td><p>Never reversal (NR) velocity for frustrated hop(s)</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><cite>always</cite></p></td>
<td><p>Always reversal (VR) of velocity for frustrated hop(s)</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p><cite>truhlar</cite></p></td>
<td><p>Velocity reversal based on Truhlar’s <span class="math notranslate nohighlight">\(\Delta V\)</span> scheme</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><cite>subotnik</cite></p></td>
<td><p>Velocity reversal based on Subotnik’s <span class="math notranslate nohighlight">\(\Delta V^2\)</span> scheme</p></td>
</tr>
<tr class="row-even"><td><p><strong>vrescale</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(\color{blue}{\text{ca}}\)</span></p></td>
<td><p>Centroid-approximation level of velocity rescaling of ring-polymer for energy conservation</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><cite>ba</cite></p></td>
<td><p>Bead-approximation level of velocity rescaling of ring-polymer for energy conservation</p></td>
</tr>
<tr class="row-even"><td><p><strong>usrkval</strong></p></td>
<td><p><cite>yes</cite></p></td>
<td><p>If TRUE, read initial momentum (k) value and overwrite <cite>param.in</cite> k-value</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><span class="math notranslate nohighlight">\(\color{blue}{\text{no}}\)</span></p></td>
<td><p>Read and use initial k-value from <cite>param.in</cite></p></td>
</tr>
<tr class="row-even"><td><p><strong>acckval</strong></p></td>
<td><p><cite>yes</cite></p></td>
<td><p>If TRUE, writes accumulated result with k-value; useful for branching probability calculation(s)</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><span class="math notranslate nohighlight">\(\color{blue}{\text{no}}\)</span></p></td>
<td><p>No accumulated result(s)</p></td>
</tr>
<tr class="row-even"><td><p><strong>rundtail</strong></p></td>
<td><p><cite>yes</cite></p></td>
<td><p>Print run-time details of the simulation</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p><span class="math notranslate nohighlight">\(\color{blue}{\text{no}}\)</span></p></td>
<td><p>No details of simulation</p></td>
</tr>
<tr class="row-even"><td><p><strong>iprint</strong></p></td>
<td><p><span class="math notranslate nohighlight">\(n\)</span></p></td>
<td><p>Print data every n timesteps</p></td>
</tr>
<tr class="row-odd"><td><p><strong>finish</strong></p></td>
<td><p><em>(empty)</em></p></td>
<td><p>End of the input file</p></td>
</tr>
</tbody>
</table>
<p><em>Legend:</em> <span class="math notranslate nohighlight">\(n\)</span> – integer, <span class="math notranslate nohighlight">\(f\)</span> – real number, <span class="math notranslate nohighlight">\(s\)</span> – string,
<span class="math notranslate nohighlight">\(\color{blue}{\text{blue}}\)</span> – denotes default value.</p>
</section>
<section id="input-file-param-in">
<h2>Input File: param.in<a class="headerlink" href="#input-file-param-in" title="Link to this heading"></a></h2>
<p>Sample configuration:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>model       tully1
method      rpsh 4
nbeads      4
ntraj       100
temp        300
timestep    0.1
vreverse    subotnik
finish
</pre></div>
</div>
</section>
<section id="output-files">
<h2>Output Files<a class="headerlink" href="#output-files" title="Link to this heading"></a></h2>
<table class="docutils align-default" id="id9">
<caption><span class="caption-text">Output Files</span><a class="headerlink" href="#id9" title="Link to this table"></a></caption>
<colgroup>
<col style="width: 30.0%" />
<col style="width: 70.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p><strong>File</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><cite>param.out</cite></p></td>
<td><p>All model parameters</p></td>
</tr>
<tr class="row-odd"><td><p><cite>dcoupling.out</cite></p></td>
<td><p>Simulation log</p></td>
</tr>
<tr class="row-even"><td><p><cite>hopping.out</cite></p></td>
<td><p>Surface hopping events</p></td>
</tr>
<tr class="row-odd"><td><p><cite>adiabat[1-2].out</cite></p></td>
<td><p>Adiabatic populations</p></td>
</tr>
<tr class="row-even"><td><p><cite>diabat[1-3].out</cite></p></td>
<td><p>Diabatic populations</p></td>
</tr>
<tr class="row-odd"><td><p><cite>pkval.out</cite></p></td>
<td><p>Branching probability (if enabled)</p></td>
</tr>
</tbody>
</table>
</section>
<section id="running-simulations">
<h2>Running Simulations<a class="headerlink" href="#running-simulations" title="Link to this heading"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./sharp.x
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sh<span class="w"> </span>submit.sh
</pre></div>
</div>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<p><strong>Example 1: Tully I (serial)</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>example/tully1/
sh<span class="w"> </span>submit.sh
</pre></div>
</div>
<p><strong>Example 2: Tully II (parallel)</strong></p>
<p>Edit <cite>param.in</cite>:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>model     tully2
method    rpsh 4
ncpu      10
</pre></div>
</div>
<p>Run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sh<span class="w"> </span>submit.sh
</pre></div>
</div>
<p><strong>Example 3: Tully III with branching probability</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>model     tully3
usrkval   yes
acckval   yes
</pre></div>
</div>
<p>Run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sh<span class="w"> </span>job.sh
</pre></div>
</div>
<p><strong>Example 4: db2lchain with detailed balance</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>model     db2lchain
method    fssh
ncpu      20
temp      1000
</pre></div>
</div>
<p>Plot results:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gnuplot<span class="w"> </span>plot4.in
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Dil Limbu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>